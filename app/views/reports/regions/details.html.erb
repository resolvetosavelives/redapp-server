<%= render "header"%>
<% if @region.is_a?(Facility) %>
  <% if current_admin.accessible_facilities(:view_reports).include?(@region) %>
    <%= render "shared/recent_bp_log",
               blood_pressures: @recent_blood_pressures,
               display_model: :facility %>
  <% end %>
<% else %>
  <%= render "facility_activity_table",
              dashboard_analytics: @dashboard_analytics,
              period: @period.type,
              row_resource: current_admin.accessible_facilities(:view_reports).order(:name),
              row_resource_title: "Facility activity",
              row_resource_description: "Registration and follow-up activity at facilities in #{@region.name}",
              row_resource_display_field: :name,
              row_resource_link: :reports_region_facility_path %>
<% end %>
<div id="data-json" style="display: none;">
  <%= raw @data.to_json %>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>